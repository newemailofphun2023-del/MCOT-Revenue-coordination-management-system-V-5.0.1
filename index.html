<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Sarabun', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
        }
        
        .app-layout {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        .sidebar {
            width: 250px;
            background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
            color: white;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
            flex-shrink: 0;
        }
        
        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-header h3 {
            font-size: 1.5em;
            color: white;
        }
        
        .menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
            color: rgba(255,255,255,0.8);
            border-left: 4px solid transparent;
        }
        
        .menu-item i {
            width: 24px;
            font-size: 1.2em;
        }
        
        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .menu-item.active {
            background: rgba(255,255,255,0.15);
            color: white;
            border-left-color: #0066cc;
        }
        
        .main-content {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            overflow: hidden;
        }
        
        .container {
            height: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .main-header {
            background: linear-gradient(135deg, #0066cc 0%, #004a99 100%);
            color: white;
            padding: 15px 20px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .main-header h1 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        
        .main-header p {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .section-header {
            background: white;
            padding: 15px 20px;
            border-bottom: 2px solid #0066cc;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            flex-shrink: 0;
        }
        
        .section-header h2 {
            color: #0066cc;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-box {
            display: flex;
            gap: 5px;
            background: #f1f5f9;
            padding: 5px;
            border-radius: 40px;
            border: 1px solid #e2e8f0;
        }
        
        .search-box input {
            border: none;
            background: transparent;
            padding: 8px 15px;
            width: 200px;
            border-radius: 40px;
        }
        
        .search-box input:focus {
            outline: none;
            background: white;
        }
        
        .search-box button {
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 40px;
            padding: 8px 20px;
            cursor: pointer;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #0066cc;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0052a3;
        }
        
        .btn-secondary {
            background: #64748b;
            color: white;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            background: #f1f5f9;
            color: #475569;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-icon:hover {
            background: #0066cc;
            color: white;
        }
        
        .btn-icon.delete:hover {
            background: #ef4444;
        }
        
        .btn-icon.phone:hover {
            background: #10b981;
        }
        
        .table-container {
            flex: 1;
            overflow: auto;
            padding: 0 20px 20px 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        th {
            background: #f8fafc;
            padding: 12px 15px;
            text-align: left;
            border-bottom: 2px solid #0066cc;
            color: #475569;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .status {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
            display: inline-block;
        }
        
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-success { background: #d1fae5; color: #065f46; }
        .status-contacted { background: #e0e7ff; color: #3730a3; }
        .status-follow_up { background: #dbeafe; color: #1e40af; }
        .status-failed { background: #fee2e2; color: #991b1b; }
        .status-not_contacted { background: #f1f5f9; color: #475569; }
        
        .calendar-container {
            padding: 20px;
            overflow-x: auto;
            flex: 1;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .calendar-title {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .calendar-title h2 {
            color: #334155;
            font-size: 1.3em;
        }
        
        .calendar-nav {
            display: flex;
            gap: 5px;
        }
        
        .calendar-nav button {
            width: 36px;
            height: 36px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 10px;
            min-width: 560px;
        }
        
        .weekday {
            text-align: center;
            padding: 10px;
            font-weight: 600;
            color: #0066cc;
            background: #f8fafc;
            border-radius: 8px;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            min-width: 560px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            background: #f8fafc;
            border-radius: 8px;
            padding: 5px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            font-size: 1.1em;
            font-weight: 500;
        }
        
        .calendar-day.today {
            background: #e0f2fe;
            border: 2px solid #0066cc;
        }
        
        .calendar-day.empty {
            background: transparent;
            border: 1px dashed #e2e8f0;
        }
        
        .appointment-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            background: #0066cc;
            color: white;
            font-size: 0.7em;
            padding: 2px 5px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }
        
        /* ‡∏•‡∏ö‡∏™‡πà‡∏ß‡∏ô dashboard-cards ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8fafc;
            position: sticky;
            top: 0;
        }
        
        .modal-header h2 {
            color: #0066cc;
            font-size: 1.2em;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            background: #f8fafc;
            position: sticky;
            bottom: 0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #334155;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .detail-row {
            display: flex;
            margin-bottom: 10px;
            padding: 8px 12px;
            background: #f8fafc;
            border-radius: 8px;
        }
        
        .detail-label {
            width: 120px;
            font-weight: 600;
            color: #0066cc;
        }
        
        .detail-value {
            flex: 1;
        }
        
        .selected-coordinators {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 8px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            background: #f8fafc;
            min-height: 40px;
            margin-top: 5px;
        }
        
        .coordinator-tag {
            background: #0066cc;
            color: white;
            padding: 4px 8px;
            border-radius: 16px;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .coordinator-tag button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 10px;
        }
        
        .settings-group {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .settings-row:last-child {
            border-bottom: none;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            border-radius: 24px;
            transition: .4s;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            border-radius: 50%;
            transition: .4s;
        }
        
        input:checked + .slider {
            background-color: #0066cc;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .backup-section {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px dashed #cbd5e1;
        }
        
        .backup-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-input input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .report-options {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
        }
        
        .report-type-selector {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .report-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .pdf-preview {
            background: white;
            padding: 20px;
            font-size: 12px;
        }
        
        .pdf-preview h2 {
            color: #0066cc;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .pdf-preview table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            min-width: auto;
        }
        
        .pdf-preview th {
            background: #f0f0f0;
            padding: 8px;
            border: 1px solid #ddd;
        }
        
        .pdf-preview td {
            padding: 6px 8px;
            border: 1px solid #ddd;
        }
        
        .pdf-preview .summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .pdf-preview .summary-item {
            background: #f8fafc;
            padding: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }
        
        .pdf-preview .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #e2e8f0;
            color: #64748b;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #cbd5e1;
        }
        
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
            padding: 12px 20px;
            border-radius: 8px;
            display: none;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        
        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        
        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        
        .credit-footer {
            background: #f8fafc;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
            padding: 10px;
            text-align: center;
            font-size: 0.85em;
            flex-shrink: 0;
        }
        
        .scrollable-content {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .tab-content {
            display: none;
            flex: 1;
            flex-direction: column;
            height: 100%;
        }
        
        .tab-content.active {
            display: flex;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            #printFrame, #printFrame * {
                visibility: visible;
            }
            #printFrame {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
            }
        }
        
        /* ===== Responsive Design ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ===== */
        @media (max-width: 768px) {
            .app-layout {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100% !important;
                height: auto;
                max-height: 50px;
                overflow: hidden;
                transition: max-height 0.3s ease;
            }
            
            .sidebar.expanded {
                max-height: 100vh;
            }
            
            .sidebar-header {
                padding: 10px 15px;
                cursor: pointer;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .sidebar-header h3 {
                font-size: 1.2em;
                margin: 0;
            }
            
            .sidebar-header::after {
                content: '\f078';
                font-family: 'Font Awesome 6 Free';
                font-weight: 900;
                font-size: 14px;
            }
            
            .sidebar.expanded .sidebar-header::after {
                content: '\f077';
            }
            
            .menu {
                display: none;
                padding: 5px 0;
            }
            
            .sidebar.expanded .menu {
                display: block;
            }
            
            .menu-item {
                padding: 10px 15px;
                font-size: 0.9em;
            }
            
            .main-content {
                padding: 8px;
            }
            
            .main-header {
                padding: 8px 12px;
            }
            
            .main-header h1 {
                font-size: 1.2em;
                margin-bottom: 3px;
            }
            
            .main-header p {
                font-size: 0.8em;
            }
            
            .section-header {
                padding: 8px 12px;
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }
            
            .section-header h2 {
                font-size: 1.1em;
                margin-bottom: 0;
            }
            
            .header-actions {
                width: 100%;
                flex-direction: column;
                gap: 8px;
            }
            
            .search-box {
                width: 100%;
                display: flex;
                gap: 5px;
            }
            
            .search-box input {
                flex: 1;
                padding: 8px 12px;
                font-size: 0.9em;
            }
            
            .search-box button {
                padding: 8px 16px;
                white-space: nowrap;
            }
            
            .btn {
                width: 100%;
                padding: 8px 12px;
                font-size: 0.9em;
                justify-content: center;
            }
            
            /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô */
            .calendar-container {
                padding: 10px;
            }
            
            .calendar-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                margin-bottom: 10px;
            }
            
            .calendar-title {
                width: 100%;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .calendar-title h2 {
                font-size: 1.1em;
            }
            
            .calendar-nav {
                display: flex;
                gap: 5px;
            }
            
            .calendar-nav button {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            .weekdays {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 2px;
                margin-bottom: 5px;
                min-width: 100%;
            }
            
            .weekday {
                padding: 5px 2px;
                font-size: 0.75em;
            }
            
            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 2px;
                min-width: 100%;
            }
            
            .calendar-day {
                aspect-ratio: 1 / 1;
                min-height: 40px;
                padding: 2px;
                font-size: 0.9em;
            }
            
            .calendar-day span {
                font-size: 0.9em;
            }
            
            .appointment-badge {
                top: 0;
                right: 0;
                font-size: 0.6em;
                padding: 1px 3px;
                min-width: 15px;
                height: 15px;
                line-height: 15px;
            }
            
            /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
            .table-container {
                overflow-x: auto;
                padding: 0 10px 10px 10px;
            }
            
            table {
                min-width: 600px;
                font-size: 0.85em;
            }
            
            th, td {
                padding: 8px 10px;
            }
            
            .status {
                padding: 3px 6px;
                font-size: 0.75em;
            }
            
            .action-group {
                display: flex;
                gap: 3px;
            }
            
            .btn-icon {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
            
            /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Modal */
            .modal-content {
                max-width: 95%;
                margin: 10px;
            }
            
            .modal-header {
                padding: 10px 15px;
            }
            
            .modal-header h2 {
                font-size: 1.1em;
            }
            
            .modal-body {
                padding: 15px;
            }
            
            .modal-footer {
                padding: 10px 15px;
            }
            
            .form-group label {
                font-size: 0.85em;
            }
            
            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 8px 10px;
                font-size: 0.9em;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Detail View */
            .detail-row {
                flex-direction: column;
                padding: 8px 12px;
            }
            
            .detail-label {
                width: 100%;
                margin-bottom: 3px;
                font-size: 0.85em;
            }
            
            .detail-value {
                font-size: 0.9em;
            }
            
            /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Footer */
            .credit-footer {
                padding: 8px;
                font-size: 0.75em;
            }
            
            .credit-footer p {
                white-space: normal;
                word-break: break-word;
            }
        }
        
        @media (max-width: 480px) {
            .calendar-day {
                min-height: 35px;
                font-size: 0.85em;
            }
            
            .weekday {
                font-size: 0.7em;
                padding: 4px 1px;
            }
            
            .main-header h1 {
                font-size: 1.1em;
            }
            
            .main-header p {
                font-size: 0.75em;
            }
            
            .section-header h2 {
                font-size: 1em;
            }
            
            .btn {
                font-size: 0.85em;
                padding: 6px 10px;
            }
            
            table {
                min-width: 550px;
                font-size: 0.8em;
            }
            
            th, td {
                padding: 6px 8px;
            }
            
            .status {
                padding: 2px 4px;
                font-size: 0.7em;
            }
            
            .btn-icon {
                width: 26px;
                height: 26px;
                font-size: 11px;
            }
            
            .credit-footer {
                font-size: 0.7em;
            }
        }
        
        @media (max-width: 360px) {
            .calendar-day {
                min-height: 30px;
                font-size: 0.8em;
            }
            
            .weekday {
                font-size: 0.65em;
            }
            
            .main-header h1 {
                font-size: 1em;
            }
            
            .section-header h2 {
                font-size: 0.95em;
            }
            
            table {
                min-width: 500px;
            }
        }
        
        @media (max-height: 500px) and (orientation: landscape) {
            .sidebar {
                max-height: 100vh;
            }
            
            .calendar-day {
                min-height: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header" onclick="toggleSidebar()">
                <h3>MCOT</h3>
            </div>
            <div class="menu">
                <div class="menu-item active" onclick="switchTab('dashboard')">
                    <i class="fas fa-calendar-alt"></i>
                    <span>‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</span>
                </div>
                <div class="menu-item" onclick="switchTab('plans')">
                    <i class="fas fa-tasks"></i>
                    <span>‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</span>
                </div>
                <div class="menu-item" onclick="switchTab('organizations')">
                    <i class="fas fa-building"></i>
                    <span>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</span>
                </div>
                <div class="menu-item" onclick="switchTab('reports')">
                    <i class="fas fa-chart-bar"></i>
                    <span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
                </div>
                <div class="menu-item" onclick="switchTab('backup')">
                    <i class="fas fa-database"></i>
                    <span>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                </div>
                <div class="menu-item" onclick="switchTab('settings')">
                    <i class="fas fa-cog"></i>
                    <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="container">
                <!-- Header -->
                <div class="main-header">
                    <h1>MCOT Phitsanulok</h1>
                    <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>
                </div>
                
                <!-- Scrollable Content -->
                <div class="scrollable-content" id="scrollableContent">
                    <!-- Dashboard Tab (‡πÑ‡∏°‡πà‡∏°‡∏µ cards ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç) -->
                    <div id="dashboard" class="tab-content active">
                        <div class="section-header">
                            <h2><i class="fas fa-calendar-alt"></i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</h2>
                            <div class="header-actions">
                                <button class="btn btn-primary" onclick="showAddPlanModal()">
                                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢
                                </button>
                            </div>
                        </div>
                        
                        <div class="calendar-container">
                            <div class="calendar-header">
                                <div class="calendar-title">
                                    <h2 id="calendarMonthYear">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569</h2>
                                    <div class="calendar-nav">
                                        <button onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                                        <button onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                                        <button onclick="goToToday()"><i class="fas fa-calendar-day"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="weekdays" id="weekdays"></div>
                            <div class="calendar-grid" id="calendarGrid"></div>
                        </div>
                        
                        <!-- ‡∏•‡∏ö‡∏™‡πà‡∏ß‡∏ô dashboard-cards ‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
                    </div>
                    
                    <!-- Plans Tab -->
                    <div id="plans" class="tab-content">
                        <div class="section-header">
                            <h2><i class="fas fa-calendar-check"></i> ‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</h2>
                            <div class="header-actions">
                                <div class="search-box">
                                    <input type="text" id="planSearch" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô...">
                                    <button onclick="searchPlans()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                                </div>
                                <button class="btn btn-primary" onclick="showAddPlanModal()">
                                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</th>
                                        <th>‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô</th>
                                        <th>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="plansList"></tbody>
                            </table>
                            <div id="plansEmpty" class="empty-state" style="display: none;">
                                <i class="fas fa-calendar-times"></i>
                                <h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</h3>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Organizations Tab -->
                    <div id="organizations" class="tab-content">
                        <div class="section-header">
                            <h2><i class="fas fa-building"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
                            <div class="header-actions">
                                <div class="search-box">
                                    <input type="text" id="orgSearch" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£...">
                                    <button onclick="searchOrganizations()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                                </div>
                                <button class="btn btn-primary" onclick="showAddOrgModal()">
                                    <i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</th>
                                        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                        <th>‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                                        <th>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="organizationsList"></tbody>
                            </table>
                            <div id="orgsEmpty" class="empty-state" style="display: none;">
                                <i class="fas fa-building"></i>
                                <h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h3>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Reports Tab -->
                    <div id="reports" class="tab-content">
                        <div class="section-header">
                            <h2><i class="fas fa-chart-bar"></i> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
                        </div>
                        <div class="table-container">
                            <div class="report-options">
                                <h3>üìä ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>
                                <div class="report-type-selector">
                                    <label>
                                        <input type="radio" name="reportType" value="plans" checked onchange="toggleReportOptions()"> 
                                        ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô
                                    </label>
                                    <label>
                                        <input type="radio" name="reportType" value="organizations" onchange="toggleReportOptions()"> 
                                        ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
                                    </label>
                                </div>
                                
                                <div id="plansReportOptions">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>üìÖ ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                            <input type="date" id="reportStart" value="2026-03-01">
                                        </div>
                                        <div class="form-group">
                                            <label>üìÖ ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                            <input type="date" id="reportEnd" value="2026-03-31">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>üîç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</label>
                                        <select id="reportPlanStatus">
                                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                            <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                            <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                                            <option value="success">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                                            <option value="failed">‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                                            <option value="follow_up">‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div id="orgsReportOptions" style="display: none;">
                                    <div class="form-group">
                                        <label>üîç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                                        <select id="reportOrgContactStatus">
                                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                            <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                                            <option value="not_contacted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>üè¢ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</label>
                                        <select id="reportOrgType">
                                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                            <option value="‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option>
                                            <option value="‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£">‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option>
                                            <option value="‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à">‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</option>
                                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="report-actions">
                                    <button class="btn btn-secondary" onclick="previewReport()">
                                        <i class="fas fa-eye"></i> ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                                    </button>
                                    <button class="btn btn-primary" onclick="printReportPDF()">
                                        <i class="fas fa-print"></i> ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                                    </button>
                                </div>
                            </div>
                            
                            <div id="reportPreview" style="display: none; margin-top: 20px;"></div>
                        </div>
                    </div>
                    
                    <!-- Backup Tab -->
                    <div id="backup" class="tab-content">
                        <div class="section-header">
                            <h2><i class="fas fa-database"></i> ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                        </div>
                        <div class="table-container">
                            <div class="backup-section">
                                <h3>üì• ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                                <p>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                                <div class="backup-actions">
                                    <button class="btn btn-success" onclick="backupData()">‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                                    <button class="btn btn-primary" onclick="downloadBackup()">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
                                </div>
                            </div>
                            <div class="backup-section">
                                <h3>üì§ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                                <p>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå JSON</p>
                                <div class="file-input">
                                    <input type="file" id="importFile" accept=".json" onchange="importData()">
                                    <button class="btn btn-warning">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</button>
                                </div>
                            </div>
                            <div class="backup-section">
                                <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                                <div class="backup-actions">
                                    <button class="btn btn-secondary" onclick="showBackupInfo()">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                                    <button class="btn btn-danger" onclick="showClearDataModal()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                                </div>
                            </div>
                            <div id="backupInfo" style="display: none; padding: 20px;"></div>
                        </div>
                    </div>
                    
                    <!-- Settings Tab -->
                    <div id="settings" class="tab-content">
                        <div class="section-header">
                            <h2><i class="fas fa-cog"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
                        </div>
                        <div class="table-container">
                            <div class="settings-group">
                                <h3>üë§ ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô</h3>
                                <div class="form-group">
                                    <label>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="newCoordName" placeholder="‡∏ä‡∏∑‡πà‡∏≠" style="flex:1">
                                        <input type="text" id="newCoordCode" placeholder="‡∏£‡∏´‡∏±‡∏™" style="width:100px">
                                        <button class="btn btn-primary" onclick="addCoordinator()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                                    </div>
                                </div>
                                <div id="coordinatorList" class="coordinator-list"></div>
                            </div>
                            <div class="settings-group">
                                <h3>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3>
                                <div class="settings-row">
                                    <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
                                    <label class="switch">
                                        <input type="checkbox" id="autoSave" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="settings-group">
                                <h3>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h3>
                                <div class="settings-row"><span>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô</span><span id="systemVersion">5.0.1</span></div>
                                <div class="settings-row"><span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</span><span id="totalPlansCount">0</span></div>
                                <div class="settings-row"><span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</span><span id="totalOrgsCount">0</span></div>
                                <div class="settings-row"><span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô</span><span id="totalCoordsCount">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Footer -->
                <div class="credit-footer">
                    <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏ ‡∏≠‡∏™‡∏°‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å FM. 106.25 MHz. | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô 5.0.1 | By Suraphun Inopas @ 2026</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Plan Detail Modal -->
    <div id="planDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</h2>
                <button class="btn-icon" onclick="closeModal('planDetailModal')">‚úï</button>
            </div>
            <div class="modal-body" id="planDetailContent"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('planDetailModal')">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-primary" onclick="editFromDetail()">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
            </div>
        </div>
    </div>
    
    <!-- Organization Detail Modal -->
    <div id="orgDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üè¢ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
                <button class="btn-icon" onclick="closeModal('orgDetailModal')">‚úï</button>
            </div>
            <div class="modal-body" id="orgDetailContent"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('orgDetailModal')">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-primary" onclick="editOrgFromDetail()">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
            </div>
        </div>
    </div>
    
    <!-- Day Detail Modal -->
    <div id="dayDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="dayDetailTitle">üìÖ ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
                <button class="btn-icon" onclick="closeModal('dayDetailModal')">‚úï</button>
            </div>
            <div class="modal-body" id="dayAppointmentsList"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('dayDetailModal')">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-primary" onclick="showAddPlanModal()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</button>
            </div>
        </div>
    </div>
    
    <!-- Add Plan Modal -->
    <div id="addPlanModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
                <button class="btn-icon" onclick="closeModal('addPlanModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏î *</label>
                    <input type="date" id="planDate">
                </div>
                <div class="form-group">
                    <label>üè¢ ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ *</label>
                    <select id="planOrg">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üë• ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô *</label>
                    <select id="planCoord" multiple size="3">
                        <option value="‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢">‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢ (CC001)</option>
                        <option value="‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç (CC002)</option>
                        <option value="‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå">‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå (CC003)</option>
                    </select>
                    <div class="selected-coordinators" id="selectedCoords"></div>
                    <small>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏î Ctrl ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ</small>
                </div>
                <div class="form-group">
                    <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ *</label>
                    <textarea id="planTarget" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</label>
                        <input type="number" id="planRevenue" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="planStatus">
                            <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                            <option value="follow_up">‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addPlanModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="addPlan()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- Edit Plan Modal -->
    <div id="editPlanModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</h2>
                <button class="btn-icon" onclick="closeModal('editPlanModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editPlanId">
                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏î *</label>
                    <input type="date" id="editPlanDate">
                </div>
                <div class="form-group">
                    <label>üè¢ ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ *</label>
                    <select id="editPlanOrg">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üë• ‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô *</label>
                    <select id="editPlanCoord" multiple size="3">
                        <option value="‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢">‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢ (CC001)</option>
                        <option value="‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç (CC002)</option>
                        <option value="‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå">‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå (CC003)</option>
                    </select>
                    <div class="selected-coordinators" id="editSelectedCoords"></div>
                </div>
                <div class="form-group">
                    <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ *</label>
                    <textarea id="editPlanTarget" rows="2"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</label>
                        <input type="number" id="editPlanRevenue" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="editPlanStatus">
                            <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                            <option value="success">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                            <option value="failed">‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                            <option value="follow_up">‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</label>
                    <textarea id="editPlanResult" rows="2"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</label>
                        <input type="number" id="editPlanActual" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>üìÖ ‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</label>
                        <input type="date" id="editPlanFollowup">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editPlanModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="updatePlan()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- Update Status Modal -->
    <div id="updateStatusModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üö© ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>
                <button class="btn-icon" onclick="closeModal('updateStatusModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="updatePlanId">
                <div class="form-group">
                    <label>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                    <select id="updateStatus">
                        <option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                        <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                        <option value="success">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                        <option value="failed">‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</option>
                        <option value="follow_up">‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</label>
                    <textarea id="updateResult" rows="2"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</label>
                        <input type="number" id="updateActual" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>üìÖ ‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</label>
                        <input type="date" id="updateFollowup">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('updateStatusModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="saveStatus()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- Add Organization Modal -->
    <div id="addOrgModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÉ‡∏´‡∏°‡πà</h2>
                <button class="btn-icon" onclick="closeModal('addOrgModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>üè¢ ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ *</label>
                    <input type="text" id="orgName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£">
                </div>
                <div class="form-group">
                    <label>üìå ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="orgType">
                        <option value="‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option>
                        <option value="‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£">‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option>
                        <option value="‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à">‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üë§ ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <input type="text" id="orgContact" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠">
                </div>
                <div class="form-group">
                    <label>üìû ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                    <input type="text" id="orgPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
                </div>
                <div class="form-group">
                    <label>üìß ‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                    <input type="email" id="orgEmail" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                </div>
                <div class="form-group">
                    <label>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <select id="orgContactStatus">
                        <option value="not_contacted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</option>
                        <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û</label>
                    <select id="orgPotential">
                        <option value="high">‡∏™‡∏π‡∏á</option>
                        <option value="medium" selected>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="low">‡∏ï‡πà‡∏≥</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addOrgModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="addOrg()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- Edit Organization Modal -->
    <div id="editOrgModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
                <button class="btn-icon" onclick="closeModal('editOrgModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editOrgId">
                <div class="form-group">
                    <label>üè¢ ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ *</label>
                    <input type="text" id="editOrgName">
                </div>
                <div class="form-group">
                    <label>üìå ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="editOrgType">
                        <option value="‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô">‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô</option>
                        <option value="‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£">‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option>
                        <option value="‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à">‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üë§ ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <input type="text" id="editOrgContact">
                </div>
                <div class="form-group">
                    <label>üìû ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                    <input type="text" id="editOrgPhone">
                </div>
                <div class="form-group">
                    <label>üìß ‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                    <input type="email" id="editOrgEmail">
                </div>
                <div class="form-group">
                    <label>üìå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <select id="editOrgStatus">
                        <option value="not_contacted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</option>
                        <option value="contacted">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û</label>
                    <select id="editOrgPotential">
                        <option value="high">‡∏™‡∏π‡∏á</option>
                        <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="low">‡∏ï‡πà‡∏≥</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editOrgModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="updateOrg()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width: 350px;">
            <div class="modal-body" style="text-align: center;">
                <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: #f59e0b; margin-bottom: 15px;"></i>
                <h3 id="confirmTitle">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
                <p id="confirmMessage" style="margin: 15px 0; color: #64748b;">‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button class="btn btn-secondary" onclick="closeModal('confirmModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn btn-danger" onclick="executeConfirm()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Clear Data Modal -->
    <div id="clearDataModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ö†Ô∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                <button class="btn-icon" onclick="closeModal('clearDataModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning" style="margin-bottom: 15px;">
                    <strong>‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô!</strong> ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ
                </div>
                <div class="form-group">
                    <label>‡∏û‡∏¥‡∏°‡∏û‡πå "<strong>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</strong>" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</label>
                    <input type="text" id="confirmClearText" placeholder="‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="confirmBackup"> 
                        ‡∏â‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('clearDataModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-danger" onclick="clearAllData()" id="clearDataBtn" disabled>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
        </div>
    </div>
    
    <!-- PDF Preview Modal -->
    <div id="pdfPreviewModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
                <button class="btn-icon" onclick="closeModal('pdfPreviewModal')">‚úï</button>
            </div>
            <div class="modal-body" id="pdfPreviewContent" style="max-height: 70vh; overflow: auto;"></div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('pdfPreviewModal')">‡∏õ‡∏¥‡∏î</button>
                <button class="btn btn-primary" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå</button>
            </div>
        </div>
    </div>
    
    <!-- Alert -->
    <div id="alertMessage" class="alert"></div>
    
    <!-- Print Frame -->
    <iframe id="printFrame" style="position: absolute; width: 0; height: 0; border: 0; visibility: hidden;"></iframe>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        let appData = {
            plans: [
                { id: 1, date: '2026-03-01', organization: '‡πÇ‡∏Å‡∏î‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', coordinator: ['‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤', status: 'pending', result: '', revenue_expected: 5000, revenue_actual: 0, follow_up_date: '' },
                { id: 2, date: '2026-03-01', organization: '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•', coordinator: ['‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤', status: 'contacted', result: '‡∏ô‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', revenue_expected: 3000, revenue_actual: 0, follow_up_date: '2026-03-05' },
                { id: 3, date: '2026-03-02', organization: '‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠', coordinator: ['‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à', status: 'pending', result: '', revenue_expected: 8000, revenue_actual: 0, follow_up_date: '' },
                { id: 4, date: '2026-03-03', organization: '‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', coordinator: ['‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', status: 'pending', result: '', revenue_expected: 4000, revenue_actual: 0, follow_up_date: '' },
                { id: 5, date: '2026-03-05', organization: '‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£', coordinator: ['‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£', status: 'success', result: '‡∏ï‡∏Å‡∏•‡∏á', revenue_expected: 6000, revenue_actual: 6000, follow_up_date: '' },
                { id: 6, date: '2026-03-08', organization: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•', coordinator: ['‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', status: 'pending', result: '', revenue_expected: 7000, revenue_actual: 0, follow_up_date: '' },
                { id: 7, date: '2026-03-10', organization: '‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏£‡πå', coordinator: ['‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢'], target: '‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à', status: 'contacted', result: '‡∏™‡∏ô‡πÉ‡∏à', revenue_expected: 9000, revenue_actual: 0, follow_up_date: '2026-03-15' },
                { id: 8, date: '2026-03-15', organization: '‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π', coordinator: ['‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç'], target: '‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', status: 'follow_up', result: '‡∏ô‡∏±‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', revenue_expected: 15000, revenue_actual: 0, follow_up_date: '2026-03-20' }
            ],
            organizations: [
                { id: 1, name: '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏û‡∏∏‡∏ó‡∏ò‡∏ä‡∏¥‡∏ô‡∏£‡∏≤‡∏ä ‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', type: '‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£', contact_person: '‡∏ô‡∏≤‡∏¢‡πÅ‡∏û‡∏ó‡∏¢‡πå ‡∏ß‡∏¥‡∏ô‡∏π‡∏•‡∏¢‡πå', phone: '055-219-1111', email: 'info@hospital.go.th', contact_status: 'contacted', potential: 'high', notes: '' },
                { id: 2, name: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', type: '‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô', contact_person: '-', phone: '055-123-4567', email: 'toyota@example.com', contact_status: 'not_contacted', potential: 'medium', notes: '' },
                { id: 3, name: '‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡πà‡∏≤‡∏ó‡∏≠‡∏á', type: '‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô', contact_person: '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤', phone: '055-123-4568', email: 'thathong@toyota.com', contact_status: 'contacted', potential: 'high', notes: '' },
                { id: 4, name: '‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ ‡∏ù‡πà‡∏≤‡∏¢‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', type: '‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à', contact_person: '‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê', phone: '055-987-6543', email: 'prasert@northern.or.th', contact_status: 'contacted', potential: 'high', notes: '' },
                { id: 5, name: '‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Ø', type: '‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£', contact_person: '‡∏Ñ‡∏∏‡∏ì‡∏§‡∏ó‡∏ò‡∏¥‡∏ä‡∏±‡∏¢', phone: '055-234-5678', email: 'ritchai@agriculture.go.th', contact_status: 'contacted', potential: 'high', notes: '' },
                { id: 6, name: '‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏Å‡πà‡∏≤', type: '‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô', contact_person: '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢', phone: '055-345-6789', email: 'somsak@nammuen.com', contact_status: 'not_contacted', potential: 'medium', notes: '' }
            ],
            coordinators: [
                { id: 1, name: '‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢', code: 'CC001' },
                { id: 2, name: '‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç', code: 'CC002' },
                { id: 3, name: '‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå', code: 'CC003' }
            ],
            settings: { auto_save: true, system_version: '5.0.1' },
            last_backup: null
        };

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
        let currentTab = 'dashboard';
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let currentPlanId = null;
        let currentOrgId = null;
        let pendingAction = null;
        const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', 
                           '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderCalendar();
            renderPlans();
            renderOrganizations();
            renderCoordinators();
            updateSystemInfo();
            startAutoSave();
            
            // Event listeners
            document.getElementById('planCoord').addEventListener('change', updateSelectedCoords);
            document.getElementById('editPlanCoord').addEventListener('change', updateEditSelectedCoords);
            document.getElementById('confirmClearText').addEventListener('input', checkClearConfirm);
            document.getElementById('confirmBackup').addEventListener('change', checkClearConfirm);
            document.querySelectorAll('input[name="reportType"]').forEach(r => {
                r.addEventListener('change', toggleReportOptions);
            });
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        function loadData() {
            const saved = localStorage.getItem('appData');
            if (saved) {
                try {
                    appData = JSON.parse(saved);
                } catch(e) {}
            }
        }

        function saveData() {
            localStorage.setItem('appData', JSON.stringify(appData));
            console.log('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß', new Date().toLocaleTimeString());
        }

        function startAutoSave() {
            setInterval(() => {
                if (document.getElementById('autoSave').checked) {
                    saveData();
                }
            }, 30000);
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('expanded');
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
            
            document.getElementById(tab).classList.add('active');
            event.target.closest('.menu-item').classList.add('active');
            
            currentTab = tab;
            
            if (tab === 'dashboard') {
                renderCalendar();
            } else if (tab === 'plans') {
                renderPlans();
            } else if (tab === 'organizations') {
                renderOrganizations();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showAlert(msg, type) {
            const alert = document.getElementById('alertMessage');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${msg}`;
            alert.style.display = 'flex';
            setTimeout(() => alert.style.display = 'none', 3000);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const weekdays = document.getElementById('weekdays');
            const monthDisplay = document.getElementById('calendarMonthYear');
            
            const thaiWeekdays = ['‡∏≠‡∏≤.', '‡∏à.', '‡∏≠.', '‡∏û.', '‡∏û‡∏§.', '‡∏®.', '‡∏™.'];
            weekdays.innerHTML = '';
            thaiWeekdays.forEach(day => {
                const div = document.createElement('div');
                div.className = 'weekday';
                div.textContent = day;
                weekdays.appendChild(div);
            });
            
            monthDisplay.textContent = `${monthNames[currentMonth]} ${currentYear + 543}`;
            
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const lastDate = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            grid.innerHTML = '';
            
            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day empty';
                grid.appendChild(emptyDiv);
            }
            
            for (let d = 1; d <= lastDate; d++) {
                const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                const appointments = appData.plans.filter(p => p.date === dateStr);
                const isToday = dateStr === new Date().toISOString().split('T')[0];
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                if (isToday) dayDiv.classList.add('today');
                
                dayDiv.innerHTML = `<span>${d}</span>${appointments.length > 0 ? `<span class="appointment-badge">${appointments.length}</span>` : ''}`;
                
                dayDiv.onclick = () => showDayDetail(dateStr, appointments);
                
                grid.appendChild(dayDiv);
            }
        }

        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }

        function goToToday() {
            const today = new Date();
            currentMonth = today.getMonth();
            currentYear = today.getFullYear();
            renderCalendar();
        }

        function showDayDetail(dateStr, appointments) {
            const modal = document.getElementById('dayDetailModal');
            const list = document.getElementById('dayAppointmentsList');
            
            const [y, m, d] = dateStr.split('-');
            document.getElementById('dayDetailTitle').innerHTML = `üìÖ ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${d}/${m}/${parseInt(y)+543}`;
            
            if (appointments.length === 0) {
                list.innerHTML = '<div class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>';
            } else {
                list.innerHTML = appointments.map(apt => {
                    const coord = apt.coordinator.join(', ');
                    return `<div class="detail-row" onclick="showPlanDetail(${apt.id})" style="cursor:pointer">
                        <strong>${apt.organization}</strong> - ${apt.target}<br>
                        <small>‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô: ${coord}</small>
                    </div>`;
                }).join('');
            }
            
            modal.style.display = 'flex';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô
        function renderPlans() {
            const list = document.getElementById('plansList');
            const search = document.getElementById('planSearch').value.toLowerCase();
            
            let filtered = appData.plans;
            if (search) {
                filtered = filtered.filter(p => 
                    p.organization.toLowerCase().includes(search) ||
                    p.target.toLowerCase().includes(search) ||
                    p.coordinator.some(c => c.toLowerCase().includes(search))
                );
            }
            
            list.innerHTML = '';
            
            if (filtered.length === 0) {
                document.getElementById('plansEmpty').style.display = 'block';
                return;
            }
            
            document.getElementById('plansEmpty').style.display = 'none';
            
            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            filtered.forEach(plan => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(plan.date)}</td>
                    <td>${plan.organization}</td>
                    <td>${plan.coordinator.join(', ')}</td>
                    <td>${plan.target.substring(0, 30)}${plan.target.length > 30 ? '...' : ''}</td>
                    <td><span class="status status-${plan.status}">${getStatusText(plan.status)}</span></td>
                    <td>
                        <button class="btn-icon" onclick="showPlanDetail(${plan.id})" title="‡∏î‡∏π">üëÅÔ∏è</button>
                        <button class="btn-icon" onclick="showUpdateStatus(${plan.id})" title="‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï">üö©</button>
                        <button class="btn-icon delete" onclick="deletePlan(${plan.id})" title="‡∏•‡∏ö">üóëÔ∏è</button>
                    </td>
                `;
                list.appendChild(row);
            });
        }

        function searchPlans() {
            renderPlans();
        }

        function showPlanDetail(id) {
            const plan = appData.plans.find(p => p.id === id);
            if (!plan) return;
            
            currentPlanId = id;
            const content = document.getElementById('planDetailContent');
            
            content.innerHTML = `
                <div class="detail-row"><span class="detail-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</span><span>${formatDate(plan.date)}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£:</span><span>${plan.organization}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô:</span><span>${plan.coordinator.join(', ')}</span></div>
                <div class="detail-row"><span class="detail-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:</span><span>${plan.target}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span><span>${getStatusText(plan.status)}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:</span><span>${plan.revenue_expected?.toLocaleString() || 0} ‡∏ö‡∏≤‡∏ó</span></div>
                <div class="detail-row"><span class="detail-label">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á:</span><span>${plan.revenue_actual?.toLocaleString() || 0} ‡∏ö‡∏≤‡∏ó</span></div>
                ${plan.result ? `<div class="detail-row"><span class="detail-label">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</span><span>${plan.result}</span></div>` : ''}
                ${plan.follow_up_date ? `<div class="detail-row"><span class="detail-label">‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°:</span><span>${formatDate(plan.follow_up_date)}</span></div>` : ''}
            `;
            
            document.getElementById('planDetailModal').style.display = 'flex';
        }

        function editFromDetail() {
            closeModal('planDetailModal');
            if (currentPlanId) showEditPlan(currentPlanId);
        }

        function showAddPlanModal() {
            const orgSelect = document.getElementById('planOrg');
            orgSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</option>';
            appData.organizations.forEach(org => {
                orgSelect.innerHTML += `<option value="${org.name}">${org.name}</option>`;
            });
            
            document.getElementById('planDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('planTarget').value = '';
            document.getElementById('planRevenue').value = '';
            document.getElementById('planStatus').value = 'pending';
            document.getElementById('selectedCoords').innerHTML = '';
            
            Array.from(document.getElementById('planCoord').options).forEach(opt => opt.selected = false);
            
            document.getElementById('addPlanModal').style.display = 'flex';
        }

        function updateSelectedCoords() {
            const select = document.getElementById('planCoord');
            const display = document.getElementById('selectedCoords');
            display.innerHTML = '';
            Array.from(select.selectedOptions).forEach(opt => {
                display.innerHTML += `<span class="coordinator-tag">${opt.text} <button onclick="removeCoord('${opt.value}')">‚úï</button></span>`;
            });
        }

        function removeCoord(name) {
            const select = document.getElementById('planCoord');
            Array.from(select.options).forEach(opt => {
                if (opt.value === name) opt.selected = false;
            });
            updateSelectedCoords();
        }

        function addPlan() {
            const date = document.getElementById('planDate').value;
            const org = document.getElementById('planOrg').value;
            const coords = Array.from(document.getElementById('planCoord').selectedOptions).map(opt => opt.value);
            const target = document.getElementById('planTarget').value;
            const revenue = parseInt(document.getElementById('planRevenue').value) || 0;
            const status = document.getElementById('planStatus').value;
            
            if (!date || !org || coords.length === 0 || !target) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö', 'error');
                return;
            }
            
            const newId = Math.max(...appData.plans.map(p => p.id), 0) + 1;
            
            appData.plans.push({
                id: newId, date, organization: org, coordinator: coords, target,
                status, revenue_expected: revenue, revenue_actual: 0,
                result: '', follow_up_date: ''
            });
            
            saveData();
            closeModal('addPlanModal');
            renderPlans();
            renderCalendar();
            showAlert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function showEditPlan(id) {
            const plan = appData.plans.find(p => p.id === id);
            if (!plan) return;
            
            document.getElementById('editPlanId').value = id;
            document.getElementById('editPlanDate').value = plan.date;
            
            const orgSelect = document.getElementById('editPlanOrg');
            orgSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</option>';
            appData.organizations.forEach(org => {
                orgSelect.innerHTML += `<option value="${org.name}" ${org.name === plan.organization ? 'selected' : ''}>${org.name}</option>`;
            });
            
            const coordSelect = document.getElementById('editPlanCoord');
            Array.from(coordSelect.options).forEach(opt => {
                opt.selected = plan.coordinator.includes(opt.value);
            });
            
            updateEditSelectedCoords();
            document.getElementById('editPlanTarget').value = plan.target || '';
            document.getElementById('editPlanRevenue').value = plan.revenue_expected || '';
            document.getElementById('editPlanStatus').value = plan.status || 'pending';
            document.getElementById('editPlanResult').value = plan.result || '';
            document.getElementById('editPlanActual').value = plan.revenue_actual || '';
            document.getElementById('editPlanFollowup').value = plan.follow_up_date || '';
            
            document.getElementById('editPlanModal').style.display = 'flex';
        }

        function updateEditSelectedCoords() {
            const select = document.getElementById('editPlanCoord');
            const display = document.getElementById('editSelectedCoords');
            display.innerHTML = '';
            Array.from(select.selectedOptions).forEach(opt => {
                display.innerHTML += `<span class="coordinator-tag">${opt.text} <button onclick="removeEditCoord('${opt.value}')">‚úï</button></span>`;
            });
        }

        function removeEditCoord(name) {
            const select = document.getElementById('editPlanCoord');
            Array.from(select.options).forEach(opt => {
                if (opt.value === name) opt.selected = false;
            });
            updateEditSelectedCoords();
        }

        function updatePlan() {
            const id = parseInt(document.getElementById('editPlanId').value);
            const plan = appData.plans.find(p => p.id === id);
            if (!plan) return;
            
            plan.date = document.getElementById('editPlanDate').value;
            plan.organization = document.getElementById('editPlanOrg').value;
            plan.coordinator = Array.from(document.getElementById('editPlanCoord').selectedOptions).map(opt => opt.value);
            plan.target = document.getElementById('editPlanTarget').value;
            plan.revenue_expected = parseInt(document.getElementById('editPlanRevenue').value) || 0;
            plan.status = document.getElementById('editPlanStatus').value;
            plan.result = document.getElementById('editPlanResult').value;
            plan.revenue_actual = parseInt(document.getElementById('editPlanActual').value) || 0;
            plan.follow_up_date = document.getElementById('editPlanFollowup').value;
            
            saveData();
            closeModal('editPlanModal');
            renderPlans();
            renderCalendar();
            showAlert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function showUpdateStatus(id) {
            const plan = appData.plans.find(p => p.id === id);
            if (!plan) return;
            
            document.getElementById('updatePlanId').value = id;
            document.getElementById('updateStatus').value = plan.status;
            document.getElementById('updateResult').value = plan.result || '';
            document.getElementById('updateActual').value = plan.revenue_actual || '';
            document.getElementById('updateFollowup').value = plan.follow_up_date || '';
            
            document.getElementById('updateStatusModal').style.display = 'flex';
        }

        function saveStatus() {
            const id = parseInt(document.getElementById('updatePlanId').value);
            const plan = appData.plans.find(p => p.id === id);
            if (!plan) return;
            
            plan.status = document.getElementById('updateStatus').value;
            plan.result = document.getElementById('updateResult').value;
            plan.revenue_actual = parseInt(document.getElementById('updateActual').value) || 0;
            plan.follow_up_date = document.getElementById('updateFollowup').value;
            
            saveData();
            closeModal('updateStatusModal');
            renderPlans();
            renderCalendar();
            showAlert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function deletePlan(id) {
            pendingAction = { type: 'delete_plan', id };
            document.getElementById('confirmTitle').textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô';
            document.getElementById('confirmMessage').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ?';
            document.getElementById('confirmModal').style.display = 'flex';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
        function renderOrganizations() {
            const list = document.getElementById('organizationsList');
            const search = document.getElementById('orgSearch').value.toLowerCase();
            
            let filtered = appData.organizations;
            if (search) {
                filtered = filtered.filter(o => 
                    o.name.toLowerCase().includes(search) ||
                    (o.contact_person || '').toLowerCase().includes(search)
                );
            }
            
            list.innerHTML = '';
            
            if (filtered.length === 0) {
                document.getElementById('orgsEmpty').style.display = 'block';
                return;
            }
            
            document.getElementById('orgsEmpty').style.display = 'none';
            
            filtered.forEach(org => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${org.name}</td>
                    <td>${org.type}</td>
                    <td>${org.contact_person || '-'}</td>
                    <td>${org.phone || '-'}</td>
                    <td><span class="status status-${org.contact_status}">${org.contact_status === 'contacted' ? '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'}</span></td>
                    <td>
                        <button class="btn-icon" onclick="showOrgDetail(${org.id})" title="‡∏î‡∏π">üëÅÔ∏è</button>
                        <button class="btn-icon phone" onclick="toggleContactStatus(${org.id})" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">üìû</button>
                        <button class="btn-icon" onclick="showEditOrg(${org.id})" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">‚úèÔ∏è</button>
                        <button class="btn-icon delete" onclick="deleteOrg(${org.id})" title="‡∏•‡∏ö">üóëÔ∏è</button>
                    </td>
                `;
                list.appendChild(row);
            });
        }

        function searchOrganizations() {
            renderOrganizations();
        }

        function showOrgDetail(id) {
            const org = appData.organizations.find(o => o.id === id);
            if (!org) return;
            
            currentOrgId = id;
            const content = document.getElementById('orgDetailContent');
            
            const potentialText = org.potential === 'high' ? '‡∏™‡∏π‡∏á' : org.potential === 'medium' ? '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' : '‡∏ï‡πà‡∏≥';
            
            content.innerHTML = `
                <div class="detail-row"><span class="detail-label">‡∏ä‡∏∑‡πà‡∏≠:</span><span>${org.name}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</span><span>${org.type}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</span><span>${org.contact_person || '-'}</span></div>
                <div class="detail-row"><span class="detail-label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</span><span>${org.phone || '-'}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</span><span>${org.email || '-'}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span><span>${org.contact_status === 'contacted' ? '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'}</span></div>
                <div class="detail-row"><span class="detail-label">‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û:</span><span>${potentialText}</span></div>
                ${org.notes ? `<div class="detail-row"><span class="detail-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</span><span>${org.notes}</span></div>` : ''}
            `;
            
            document.getElementById('orgDetailModal').style.display = 'flex';
        }

        function editOrgFromDetail() {
            closeModal('orgDetailModal');
            if (currentOrgId) showEditOrg(currentOrgId);
        }

        function toggleContactStatus(id) {
            const org = appData.organizations.find(o => o.id === id);
            if (org) {
                org.contact_status = org.contact_status === 'contacted' ? 'not_contacted' : 'contacted';
                saveData();
                renderOrganizations();
                showAlert(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô ${org.contact_status === 'contacted' ? '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'}`, 'success');
            }
        }

        function showAddOrgModal() {
            document.getElementById('addOrgModal').style.display = 'flex';
        }

        function addOrg() {
            const name = document.getElementById('orgName').value;
            if (!name) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£', 'error');
                return;
            }
            
            const newId = Math.max(...appData.organizations.map(o => o.id), 0) + 1;
            
            appData.organizations.push({
                id: newId,
                name: name,
                type: document.getElementById('orgType').value,
                contact_person: document.getElementById('orgContact').value,
                phone: document.getElementById('orgPhone').value,
                email: document.getElementById('orgEmail').value,
                contact_status: document.getElementById('orgContactStatus').value,
                potential: document.getElementById('orgPotential').value,
                notes: ''
            });
            
            saveData();
            closeModal('addOrgModal');
            renderOrganizations();
            showAlert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function showEditOrg(id) {
            const org = appData.organizations.find(o => o.id === id);
            if (!org) return;
            
            document.getElementById('editOrgId').value = id;
            document.getElementById('editOrgName').value = org.name;
            document.getElementById('editOrgType').value = org.type;
            document.getElementById('editOrgContact').value = org.contact_person || '';
            document.getElementById('editOrgPhone').value = org.phone || '';
            document.getElementById('editOrgEmail').value = org.email || '';
            document.getElementById('editOrgStatus').value = org.contact_status || 'not_contacted';
            document.getElementById('editOrgPotential').value = org.potential || 'medium';
            
            document.getElementById('editOrgModal').style.display = 'flex';
        }

        function updateOrg() {
            const id = parseInt(document.getElementById('editOrgId').value);
            const org = appData.organizations.find(o => o.id === id);
            if (!org) return;
            
            org.name = document.getElementById('editOrgName').value;
            org.type = document.getElementById('editOrgType').value;
            org.contact_person = document.getElementById('editOrgContact').value;
            org.phone = document.getElementById('editOrgPhone').value;
            org.email = document.getElementById('editOrgEmail').value;
            org.contact_status = document.getElementById('editOrgStatus').value;
            org.potential = document.getElementById('editOrgPotential').value;
            
            saveData();
            closeModal('editOrgModal');
            renderOrganizations();
            showAlert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function deleteOrg(id) {
            pendingAction = { type: 'delete_org', id };
            document.getElementById('confirmTitle').textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£';
            document.getElementById('confirmMessage').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ô‡∏µ‡πâ?';
            document.getElementById('confirmModal').style.display = 'flex';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô
        function renderCoordinators() {
            const list = document.getElementById('coordinatorList');
            list.innerHTML = '';
            appData.coordinators.forEach(coord => {
                const div = document.createElement('div');
                div.className = 'coordinator-item';
                div.innerHTML = `
                    <span>${coord.name} (${coord.code})</span>
                    <button class="btn-icon delete" onclick="deleteCoord(${coord.id})">üóëÔ∏è</button>
                `;
                list.appendChild(div);
            });
        }

        function addCoordinator() {
            const name = document.getElementById('newCoordName').value.trim();
            const code = document.getElementById('newCoordCode').value.trim();
            
            if (!name || !code) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™', 'error');
                return;
            }
            
            if (appData.coordinators.some(c => c.name === name || c.code === code)) {
                showAlert('‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß', 'error');
                return;
            }
            
            const newId = Math.max(...appData.coordinators.map(c => c.id), 0) + 1;
            appData.coordinators.push({ id: newId, name, code });
            
            saveData();
            renderCoordinators();
            showAlert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function deleteCoord(id) {
            const coord = appData.coordinators.find(c => c.id === id);
            if (!coord) return;
            
            const used = appData.plans.some(p => p.coordinator.includes(coord.name));
            if (used) {
                showAlert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô', 'error');
                return;
            }
            
            appData.coordinators = appData.coordinators.filter(c => c.id !== id);
            saveData();
            renderCoordinators();
            showAlert('‡∏•‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function updateSystemInfo() {
            document.getElementById('totalPlansCount').textContent = appData.plans.length;
            document.getElementById('totalOrgsCount').textContent = appData.organizations.length;
            document.getElementById('totalCoordsCount').textContent = appData.coordinators.length;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function backupData() {
            saveData();
            showAlert('‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
        }

        function downloadBackup() {
            appData.last_backup = new Date().toISOString();
            saveData();
            
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            showAlert('‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        function importData() {
            const file = document.getElementById('importFile').files[0];
            if (!file) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (!data.plans || !data.organizations) {
                        showAlert('‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                        return;
                    }
                    
                    if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà')) {
                        appData = data;
                        saveData();
                        location.reload();
                    }
                } catch (error) {
                    showAlert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ', 'error');
                }
            };
            reader.readAsText(file);
        }

        function showBackupInfo() {
            const info = document.getElementById('backupInfo');
            const lastBackup = appData.last_backup ? new Date(appData.last_backup).toLocaleString('th-TH') : '‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            
            info.innerHTML = `
                <div style="background:#f8fafc; padding:15px; border-radius:8px;">
                    <h4>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á</h4>
                    <p>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: ${appData.settings.system_version}</p>
                    <p>‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô: ${appData.plans.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                    <p>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£: ${appData.organizations.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                    <p>‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô: ${appData.coordinators.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                    <p>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${lastBackup}</p>
                    <p>‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${(JSON.stringify(appData).length / 1024).toFixed(2)} KB</p>
                </div>
            `;
            info.style.display = 'block';
        }

        function showClearDataModal() {
            document.getElementById('clearDataModal').style.display = 'flex';
        }

        function checkClearConfirm() {
            const text = document.getElementById('confirmClearText').value;
            const backup = document.getElementById('confirmBackup').checked;
            document.getElementById('clearDataBtn').disabled = !(text === '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' && backup);
        }

        function clearAllData() {
            appData.plans = [];
            appData.organizations = [];
            appData.coordinators = [
                { id: 1, name: '‡∏ä‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏¢', code: 'CC001' },
                { id: 2, name: '‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç', code: 'CC002' },
                { id: 3, name: '‡∏™‡∏∏‡∏£‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå', code: 'CC003' }
            ];
            appData.last_backup = null;
            
            saveData();
            closeModal('clearDataModal');
            renderPlans();
            renderOrganizations();
            renderCalendar();
            renderCoordinators();
            updateSystemInfo();
            showAlert('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
        function toggleReportOptions() {
            const type = document.querySelector('input[name="reportType"]:checked').value;
            document.getElementById('plansReportOptions').style.display = type === 'plans' ? 'block' : 'none';
            document.getElementById('orgsReportOptions').style.display = type === 'organizations' ? 'block' : 'none';
        }

        function previewReport() {
            const type = document.querySelector('input[name="reportType"]:checked').value;
            
            if (type === 'plans') {
                generatePlansReport(true);
            } else {
                generateOrgsReport(true);
            }
        }

        function generatePlansReport(preview = false) {
            const start = document.getElementById('reportStart').value;
            const end = document.getElementById('reportEnd').value;
            const status = document.getElementById('reportPlanStatus').value;
            
            if (!start || !end) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', 'error');
                return null;
            }
            
            let plans = appData.plans.filter(p => p.date >= start && p.date <= end);
            if (status !== 'all') {
                plans = plans.filter(p => p.status === status);
            }
            
            if (plans.length === 0) {
                showAlert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', 'error');
                return null;
            }
            
            const total = plans.length;
            const success = plans.filter(p => p.status === 'success').length;
            const failed = plans.filter(p => p.status === 'failed').length;
            const pending = plans.filter(p => ['pending', 'contacted', 'follow_up'].includes(p.status)).length;
            const expectedRevenue = plans.reduce((sum, p) => sum + (p.revenue_expected || 0), 0);
            const actualRevenue = plans.reduce((sum, p) => sum + (p.revenue_actual || 0), 0);
            const successRate = total > 0 ? ((success / total) * 100).toFixed(1) : 0;
            
            let tableRows = '';
            plans.sort((a, b) => a.date.localeCompare(b.date)).forEach(plan => {
                tableRows += `
                    <tr>
                        <td>${formatDate(plan.date)}</td>
                        <td>${plan.organization}</td>
                        <td>${plan.coordinator.join(', ')}</td>
                        <td>${plan.target}</td>
                        <td>${getStatusText(plan.status)}</td>
                        <td style="text-align: right">${plan.revenue_expected?.toLocaleString() || '-'}</td>
                        <td style="text-align: right">${plan.revenue_actual?.toLocaleString() || '-'}</td>
                        <td>${plan.result || '-'}</td>
                    </tr>
                `;
            });
            
            const html = `
                <div class="pdf-preview">
                    <h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 20px;">
                        ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏ ‡∏≠‡∏™‡∏°‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å FM. 106.25 MHz.
                    </p>
                    <p style="text-align: center; margin-bottom: 20px;">
                        ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formatDate(start)} ‡∏ñ‡∏∂‡∏á ${formatDate(end)}
                    </p>
                    
                    <div class="summary">
                        <div class="summary-item">
                            <div>‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">${total}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #10b981;">${success}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #f59e0b;">${pending}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #ef4444;">${failed}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">${expectedRevenue.toLocaleString()}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #10b981;">${actualRevenue.toLocaleString()}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">${successRate}%</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">
                                ${actualRevenue > 0 ? ((actualRevenue / expectedRevenue * 100).toFixed(1) + '%') : '0%'}
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px; color: #334155;">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</th>
                                <th>‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô</th>
                                <th>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á</th>
                                <th>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</th>
                                <th>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tableRows}
                        </tbody>
                    </table>
                    
                    <div class="footer">
                        <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleDateString('th-TH', { 
                            day: '2-digit', month: '2-digit', year: 'numeric', 
                            hour: '2-digit', minute: '2-digit' 
                        })} ‡∏ô.</p>
                        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏ ‡∏≠‡∏™‡∏°‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å FM. 106.25 MHz.</p>
                    </div>
                </div>
            `;
            
            if (preview) {
                document.getElementById('reportPreview').innerHTML = html;
                document.getElementById('reportPreview').style.display = 'block';
            }
            
            return html;
        }

        function generateOrgsReport(preview = false) {
            const status = document.getElementById('reportOrgContactStatus').value;
            const type = document.getElementById('reportOrgType').value;
            
            let orgs = appData.organizations;
            if (status !== 'all') {
                orgs = orgs.filter(o => o.contact_status === status);
            }
            if (type !== 'all') {
                orgs = orgs.filter(o => o.type === type);
            }
            
            if (orgs.length === 0) {
                showAlert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', 'error');
                return null;
            }
            
            const total = orgs.length;
            const contacted = orgs.filter(o => o.contact_status === 'contacted').length;
            const notContacted = orgs.filter(o => o.contact_status === 'not_contacted').length;
            const contactRate = total > 0 ? ((contacted / total) * 100).toFixed(1) : 0;
            
            let tableRows = '';
            orgs.sort((a, b) => a.name.localeCompare(b.name)).forEach(org => {
                const potentialText = org.potential === 'high' ? '‡∏™‡∏π‡∏á' : org.potential === 'medium' ? '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' : '‡∏ï‡πà‡∏≥';
                
                tableRows += `
                    <tr>
                        <td>${org.name}</td>
                        <td>${org.type}</td>
                        <td>${org.contact_person || '-'}</td>
                        <td>${org.phone || '-'}</td>
                        <td>${org.email || '-'}</td>
                        <td>${org.contact_status === 'contacted' ? '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'}</td>
                        <td>${potentialText}</td>
                        <td>${org.notes || '-'}</td>
                    </tr>
                `;
            });
            
            const html = `
                <div class="pdf-preview">
                    <h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 20px;">
                        ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏ ‡∏≠‡∏™‡∏°‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å FM. 106.25 MHz.
                    </p>
                    <p style="text-align: center; margin-bottom: 20px;">
                        ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${formatDate(new Date().toISOString().split('T')[0])}
                    </p>
                    
                    <div class="summary">
                        <div class="summary-item">
                            <div>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">${total}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #10b981;">${contacted}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #f59e0b;">${notContacted}</div>
                        </div>
                        <div class="summary-item">
                            <div>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</div>
                            <div style="font-size: 1.2em; font-weight: bold; color: #0066cc;">${contactRate}%</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px; color: #334155;">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</th>
                                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th>‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                                <th>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</th>
                                <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                                <th>‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û</th>
                                <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tableRows}
                        </tbody>
                    </table>
                    
                    <div class="footer">
                        <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleDateString('th-TH', { 
                            day: '2-digit', month: '2-digit', year: 'numeric', 
                            hour: '2-digit', minute: '2-digit' 
                        })} ‡∏ô.</p>
                        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏ ‡∏≠‡∏™‡∏°‡∏ó ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å FM. 106.25 MHz.</p>
                    </div>
                </div>
            `;
            
            if (preview) {
                document.getElementById('reportPreview').innerHTML = html;
                document.getElementById('reportPreview').style.display = 'block';
            }
            
            return html;
        }

        function printReportPDF() {
            const type = document.querySelector('input[name="reportType"]:checked').value;
            let html = '';
            
            if (type === 'plans') {
                html = generatePlansReport(false);
            } else {
                html = generateOrgsReport(false);
            }
            
            if (!html) return;
            
            const printFrame = document.getElementById('printFrame');
            const frameDoc = printFrame.contentDocument || printFrame.contentWindow.document;
            
            frameDoc.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</title>
                    <style>
                        @page {
                            size: A4 landscape;
                            margin: 1.5cm;
                        }
                        body {
                            font-family: 'Sarabun', sans-serif;
                            margin: 0;
                            padding: 20px;
                            background: white;
                        }
                        .pdf-preview {
                            max-width: 100%;
                        }
                        .pdf-preview h2 {
                            color: #0066cc;
                            text-align: center;
                            margin-bottom: 20px;
                        }
                        .pdf-preview table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-top: 20px;
                            font-size: 11px;
                        }
                        .pdf-preview th {
                            background: #f0f0f0;
                            padding: 8px;
                            border: 1px solid #ddd;
                            text-align: left;
                        }
                        .pdf-preview td {
                            padding: 6px 8px;
                            border: 1px solid #ddd;
                        }
                        .pdf-preview .summary {
                            display: grid;
                            grid-template-columns: repeat(4, 1fr);
                            gap: 10px;
                            margin-bottom: 30px;
                        }
                        .pdf-preview .summary-item {
                            background: #f8fafc;
                            padding: 10px;
                            text-align: center;
                            border: 1px solid #e2e8f0;
                            border-radius: 8px;
                        }
                        .pdf-preview .footer {
                            text-align: center;
                            margin-top: 40px;
                            padding-top: 10px;
                            border-top: 1px solid #e2e8f0;
                            color: #64748b;
                            font-size: 10px;
                        }
                    </style>
                </head>
                <body>
                    ${html}
                    <script>
                        window.onload = function() {
                            window.print();
                            setTimeout(function() { window.close(); }, 500);
                        };
                    <\/script>
                </body>
                </html>
            `);
            
            frameDoc.close();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö
        function executeConfirm() {
            if (!pendingAction) return;
            
            if (pendingAction.type === 'delete_plan') {
                appData.plans = appData.plans.filter(p => p.id !== pendingAction.id);
                saveData();
                renderPlans();
                renderCalendar();
                showAlert('‡∏•‡∏ö‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            } else if (pendingAction.type === 'delete_org') {
                appData.organizations = appData.organizations.filter(o => o.id !== pendingAction.id);
                saveData();
                renderOrganizations();
                showAlert('‡∏•‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            }
            
            closeModal('confirmModal');
            pendingAction = null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏£‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå
        function formatDate(date) {
            if (!date) return '';
            const [y, m, d] = date.split('-');
            return `${d}/${m}/${parseInt(y) + 543}`;
        }

        function getStatusText(status) {
            const map = {
                'pending': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                'contacted': '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß',
                'success': '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                'failed': '‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                'follow_up': '‡∏ô‡∏±‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°'
            };
            return map[status] || status;
        }
    </script>
</body>
</html>
